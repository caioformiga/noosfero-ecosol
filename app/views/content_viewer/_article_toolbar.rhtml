<div class="<%= 'logged-in' if user %>">
  <div id="article-actions">
    <% if @page.allow_edit?(user) %>
      <%= link_to content_tag( 'span', label_for_edit_article(@page) ),
          profile.admin_url.merge({ :controller => 'cms', :action => 'edit', :id => @page.id }),
          :class => 'button with-text icon-edit' %>
    <% end %>

    <% if !@page.has_posts? and @page.allow_delete?(user) %>
      <%= link_to content_tag( 'span', _('Delete') ),
        profile.admin_url.merge({ :controller => 'cms', :action => 'destroy', :id => @page}),
        :method => :post,
        :class => 'button with-text icon-delete',
        :confirm => delete_article_message(@page) %>
    <% end %>

    <% if !@page.folder? && @page.allow_spread?(user) %>
      <% if profile.kind_of?(Person) %>
        <%= link_to content_tag( 'span', _('Spread this') ),
            profile.admin_url.merge({ :controller => 'cms', :action => 'publish', :id => @page }),
            :class => 'button with-text icon-spread' %>
      <% elsif profile.kind_of?(Community) && environment.portal_community %>
        <%= link_to content_tag( 'span', _('Spread this') ),
            profile.admin_url.merge({ :controller => 'cms', :action => 'publish_on_portal_community', :id => @page }),
            :class => 'button with-text icon-spread' %>
      <% end %>
    <% end %>

    <% if !@page.gallery? && @page.allow_create?(user) %>
      <%= link_to _('Add translation'),
          profile.admin_url.merge(:controller => 'cms', :action => 'new',
                                  :parent_id => (@page.folder? ? @page : (@page.parent.nil? ? nil : @page.parent)),
                                  :type => @page.type, :article => { :translation_of_id => @page.native_translation.id }),
          :class => 'button with-text icon-locale' if @page.translatable? && !@page.native_translation.language.blank? %>
      <%= lightbox_remote_button(:new, label_for_new_article(@page), profile.admin_url.merge(:controller => 'cms', :action => 'new', :parent_id => (@page.folder? ? @page : (@page.parent.nil? ? nil : @page.parent)))) %>
    <% end %>

    <% if @page.accept_uploads? && @page.allow_create?(user) %>
      <%= button('upload-file', _('Upload files'), profile.admin_url.merge(:controller => 'cms', :action => 'upload_files', :parent_id => (@page.folder? ? @page : @page.parent))) %>
    <% end %>

    <% if !@page.allow_create?(user) && profile.community? && (@page.blog? || @page.parent && @page.parent.blog?) %>
      <%= link_to content_tag( 'span', _('Suggest an article') ), profile.admin_url.merge({ :controller => 'cms', :action => 'suggest_an_article'}), :id => 'suggest-article-link', :class => 'button with-text icon-new' %>
    <% end %>

    <%= report_abuse(profile, :link, @page) %>

  </div>
</div>
